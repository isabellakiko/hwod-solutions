{
  "id": "144",
  "title": "文本统计分析",
  "examType": "A",
  "score": 200,
  "description": "有一个文件，包含以一定规则写作的文本，请统计文件中包含的文本数量。\n规则如下：\n文本以”;”分隔，最后一条可以没有”;”，但空文本不能算语句，比如”COMMAND A; ;”只能算一条语句。注意，无字符/空白字符/制表符都算作”空”文本； 文本可以跨行，比如下面，是一条文本，而不是三条；\n文本以”;”分隔，最后一条可以没有”;”，但空文本不能算语句，比如”COMMAND A; ;”只能算一条语句。注意，无字符/空白字符/制表符都算作”空”文本；\n文本可以跨行，比如下面，是一条文本，而不是三条；\n123\n文本支持字符串，字符串为成对的单引号(')或者成对的双引号(“)，字符串可能出现用转义字符()处理的单双引号(“your input is””)和转义字符本身，比如\n1\n支持注释，可以出现在字符串之外的任意位置注释以”–“开头，到换行结束，比如：\n123\n注意字符串内的”–“，不是注释。",
  "inputDesc": "文本文件",
  "outputDesc": "包含的文本数量\n输入\n输出\n题目要求编写一个程序来统计一个文本文件中包含的文本数量。这里的“文本”指的是符合一定规则的字符串序列。具体规则如下：\n文本以分号(;)分隔，最后一条文本可以没有分号结尾。\n如果一段文本只包含空白字符（如空格、制表符等），则不算作一条有效文本。例如，\"COMMAND A; ;\"中只有一条有效文本。\"COMMAND A; B;\"为两条有效文本。\n文本可以跨越多行。也就是说，一个文本的内容可以分布在多个连续的行中，这些行合起来算作一条文本。\n文本支持字符串，字符串可以用单引号(')或双引号(\")包裹。字符串内部可能包含转义的引号（例如\"Say \\\"hello\\\"\"）和转义字符本身（例如\\）。\n在单引号和双引号的;,无法作为一条文本结束的标志.\n支持注释，注释以连续的两个减号(--)开头，并且一直延续到当前行的末尾。注释只能出现在字符串之外的位置。在字符串内的减号不算作注释的开始。在注释后面的;,无法作为一条文本结束的标志。\n单引号和双引号内的注释失效\n备注：这里博主默认是注释【后面】的;，是无法作为文本结束的标志。但是有读者提出是不是默认带注释的那一行的分号（即那一行分号的【前面】和【后面】）都无法作为文本结束的标志？机考时如果不是100%通过率，可以试试：带注释的那一行的分号都无法作为文本结束的标志",
  "examples": [
    {
      "input": "COMMAND A;\nCOMMAND B;",
      "output": "2",
      "explanation": "两条以分号结尾的语句"
    },
    {
      "input": "COMMAND A; ;",
      "output": "1",
      "explanation": "第二个分号前只有空格，不算有效语句，只有1条"
    },
    {
      "input": "SELECT -- comment\nFROM;",
      "output": "1",
      "explanation": "注释到行尾，SELECT和FROM合起来是一条跨行语句"
    }
  ],
  "solution": "**解题思路：**\n\n本题是一道**状态机模拟**问题。\n\n**核心思路：**\n- 用状态变量跟踪是否在字符串/注释内\n- 分号作为语句分隔符，但字符串和注释内的分号无效\n\n**算法步骤：**\n1. 遍历每个字符，维护inString和inComment状态\n2. 遇到--且不在字符串内，进入注释状态直到换行\n3. 遇到引号，切换字符串状态，处理转义引号\n4. 遇到分号且不在字符串内，若当前文本非空则计数+1\n5. 最后一条语句可能没有分号，需额外处理\n\n**时间复杂度**：O(N)",
  "codes": {
    "java": "import java.util.Scanner;\n\npublic class Main {\n    public static void main(String[] args) {\n        // 创建Scanner对象用于获取用户输入\n        Scanner scanner = new Scanner(System.in);\n        // 使用StringBuilder来构建整个输入文本\n        StringBuilder input = new StringBuilder();\n        // 循环读取每一行输入直到没有新的输入\n        while (scanner.hasNextLine()) {\n            // 将读取的每一行追加到StringBuilder对象，并添加换行符\n            input.append(scanner.nextLine()).append(\"\\n\");\n        }\n        // 关闭Scanner对象\n        scanner.close();\n        // 输出文本统计结果\n        System.out.println(countTexts(input.toString()));\n    }\n\n    // 统计文本中的文本数量\n    private static int countTexts(String input) {\n        // 初始化计数器\n        int count = 0;\n        // 标记是否在字符串内部\n        boolean inString = false;\n        // 标记是否在注释内部\n        boolean inComment = false;\n        // 记录字符串分隔符\n        char stringDelimiter = 0;\n        // 标记当前是否为空文本（即没有遇到非空白字符）\n        boolean isEmpty = true;\n\n        // 遍历输入文本的每个字符\n        for (int i = 0; i < input.length(); i++) {\n            // 当前字符\n            char c = input.charAt(i);\n            // 下一个字符（如果存在）\n            char nextChar = (i + 1 < input.length()) ? input.charAt(i + 1) : '\\0';\n\n            // 如果在注释中\n            if (inComment) {\n                // 如果遇到换行符，则注释结束\n                if (c == '\\n') {\n                    inComment = false;\n                }\n                continue;\n            }\n\n            // 如果遇到连续的两个减号，并且不在字符串内，则进入注释状态\n            if (c == '-' && nextChar == '-' && !inString) {\n                inComment = true;\n                continue;\n            }\n\n            // 如果遇到单引号或双引号，并且不在字符串内，则进入字符串状态\n            if ((c == '\\'' || c == '\\\"') && !inString) {\n                inString = true;\n                stringDelimiter = c;\n                isEmpty = false;\n                continue;\n            }\n\n            // 如果在字符串内，并且遇到了相同的分隔符，则检查是否为转义\n            if (c == stringDelimiter && inString) {\n                if (nextChar == stringDelimiter) {\n                    i++; // 跳过转义的引号\n                } else {\n                    inString = false; // 字符串结束\n                }\n                continue;\n            }\n\n            // 如果遇到分号，并且不在字符串内，则增加计数器\n            if (c == ';' && !inString) {\n                if (!isEmpty) {\n                    count++;\n                    isEmpty = true;\n                }\n                continue;\n            }\n\n            // 如果遇到非空白字符，并且不在字符串内，则标记为非空文本\n            if (!Character.isWhitespace(c) && !inString) {\n                isEmpty = false;\n            }\n        }\n\n        // 如果最后一个文本没有闭合的分号，则增加计数器\n        if (!isEmpty) {\n            count++; // 最后一个文本没有闭合分号\n        }\n\n        return count;\n    }\n}",
    "python": "import sys\n\n# 统计文本中的文本数量\ndef count_texts(input):\n    # 初始化计数器\n    count = 0\n    # 标记是否在字符串内部\n    in_string = False\n    # 标记是否在注释内部\n    in_comment = False\n    # 记录字符串分隔符\n    string_delimiter = ''\n    # 标记当前是否为空文本（即没有遇到非空白字符）\n    isEmpty = True\n\n    # 遍历输入文本的每个字符\n    for i, c in enumerate(input):\n        # 下一个字符（如果存在）\n        next_char = input[i + 1] if i + 1 < len(input) else '\\0'\n\n        # 如果在注释中\n        if in_comment:\n            # 如果遇到换行符，则注释结束\n            if c == '\\n':\n                in_comment = False\n            continue\n\n        # 如果遇到连续的两个减号，并且不在字符串内，则进入注释状态\n        if c == '-' and next_char == '-' and not in_string:\n            in_comment = True\n            i += 1  # 跳过下一个减号\n            continue\n\n        # 如果遇到单引号或双引号，并且不在字符串内，则进入字符串状态\n        if (c == '\\'' or c == '\\\"') and not in_string:\n            in_string = True\n            string_delimiter = c\n            isEmpty = False\n            continue\n\n        # 如果在字符串内，并且遇到了相同的分隔符，则检查是否为转义\n        if c == string_delimiter and in_string:\n            if next_char == string_delimiter:\n                i += 1  # 跳过转义的引号\n            else:\n                in_string = False  # 字符串结束\n            continue\n\n        # 如果遇到分号，并且不在字符串内，则增加计数器\n        if c == ';' and not in_string:\n            if not isEmpty:\n                count += 1\n                isEmpty = True\n            continue\n\n        # 如果遇到非空白字符，并且不在字符串内，则标记为非空文本\n        if not c.isspace() and not in_string:\n            isEmpty = False\n\n    # 如果最后一个文本没有闭合的分号，则增加计数器\n    if not isEmpty:\n        count += 1  # 最后一个文本没有闭合分号\n\n    return count\n\n# 主函数\nif __name__ == \"__main__\":\n    # 使用字符串来构建整个输入文本\n    input = sys.stdin.read()\n    # 输出文本统计结果\n    print(count_texts(input))",
    "javascript": "",
    "cpp": "#include <iostream>\n#include <string>\n\n// 统计文本中的文本数量\nint countTexts(const std::string& input) {\n    // 初始化计数器\n    int count = 0;\n    // 标记是否在字符串内部\n    bool inString = false;\n    // 标记是否在注释内部\n    bool inComment = false;\n    // 记录字符串分隔符\n    char stringDelimiter = 0;\n    // 标记当前是否为空文本（即没有遇到非空白字符）\n    bool isEmpty = true;\n\n    // 遍历输入文本的每个字符\n    for (size_t i = 0; i < input.length(); ++i) {\n        // 当前字符\n        char c = input[i];\n        // 下一个字符（如果存在）\n        char nextChar = (i + 1 < input.length()) ? input[i + 1] : '\\0';\n\n        // 如果在注释中\n        if (inComment) {\n            // 如果遇到换行符，则注释结束\n            if (c == '\\n') {\n                inComment = false;\n            }\n            continue;\n        }\n\n        // 如果遇到连续的两个减号，并且不在字符串内，则进入注释状态\n        if (c == '-' && nextChar == '-' && !inString) {\n            inComment = true;\n            i++; // 跳过下一个减号\n            continue;\n        }\n\n        // 如果遇到单引号或双引号，并且不在字符串内，则进入字符串状态\n        if ((c == '\\'' || c == '\\\"') && !inString) {\n            inString = true;\n            stringDelimiter = c;\n            isEmpty = false;\n            continue;\n        }\n\n        // 如果在字符串内，并且遇到了相同的分隔符，则检查是否为转义\n        if (c == stringDelimiter && inString) {\n            if (nextChar == stringDelimiter) {\n                i++; // 跳过转义的引号\n            } else {\n                inString = false; // 字符串结束\n            }\n            continue;\n        }\n\n        // 如果遇到分号，并且不在字符串内，则增加计数器\n        if (c == ';' && !inString) {\n            if (!isEmpty) {\n                count++;\n                isEmpty = true;\n            }\n            continue;\n        }\n\n        // 如果遇到非空白字符，并且不在字符串内，则标记为非空文本\n        if (!isspace(c) && !inString) {\n            isEmpty = false;\n        }\n    }\n\n    // 如果最后一个文本没有闭合的分号，则增加计数器\n    if (!isEmpty) {\n        count++; // 最后一个文本没有闭合分号\n    }\n\n    return count;\n}\n// 主函数\nint main() {\n    // 创建字符串用于获取用户输入\n    std::string input;\n    // 获取用户输入直到EOF\n    for (std::string line; std::getline(std::cin, line);) {\n        // 将读取的每一行追加到input字符串，并添加换行符\n        input += line + \"\\n\";\n    }\n    // 输出文本统计结果\n    std::cout << countTexts(input) << std::endl;\n    return 0;\n}",
    "c": "#include <stdio.h>\n#include <stdbool.h>\n#include <string.h>\n#include <ctype.h>\n\n// 定义最大输入长度\n#define MAX_INPUT_LENGTH 10000\n\n// 函数声明：统计文本中的文本数量\nint countTexts(const char *input);\n\nint main() {\n    // 用来存储输入的字符数组\n    char input[MAX_INPUT_LENGTH] = {0};\n    // 临时字符串存储一行输入\n    char temp[256];\n \n \n    // 循环读取输入直到EOF（文件结束标志）\n    while (fgets(temp, sizeof(temp), stdin) != NULL) {\n        // 将临时字符串追加到输入数组中\n        strcat(input, temp);\n    }\n\n    // 输出文本统计结果\n    printf(\"%d\\n\", countTexts(input));\n\n    return 0;\n}\n\n// 实现统计文本数量的函数\nint countTexts(const char *input) {\n    // 初始化计数器\n    int count = 0;\n    // 标记是否在字符串内部\n    bool inString = false;\n    // 标记是否在注释内部\n    bool inComment = false;\n    // 记录字符串分隔符\n    char stringDelimiter = 0;\n    // 标记当前是否为空文本\n    bool isEmpty = true;\n\n    // 遍历输入文本的每个字符\n    for (int i = 0; input[i] != '\\0'; i++) {\n        char c = input[i];\n        char nextChar = input[i + 1];\n\n        // 处理注释\n        if (inComment) {\n            if (c == '\\n') {\n                inComment = false;\n            }\n            continue;\n        }\n\n        // 进入注释状态\n        if (c == '-' && nextChar == '-' && !inString) {\n            inComment = true;\n            i++; // 跳过下一个减号\n            continue;\n        }\n\n        // 进入字符串状态\n        if ((c == '\\'' || c == '\\\"') && !inString) {\n            inString = true;\n            stringDelimiter = c;\n            isEmpty = false;\n            continue;\n        }\n\n        // 结束字符串状态\n        if (c == stringDelimiter && inString) {\n            if (nextChar == stringDelimiter) {\n                i++; // 跳过转义的引号\n            } else {\n                inString = false;\n            }\n            continue;\n        }\n\n        // 处理分号，增加计数\n        if (c == ';' && !inString) {\n            if (!isEmpty) {\n                count++;\n                isEmpty = true;\n            }\n            continue;\n        }\n\n        // 处理非空白字符\n        if (!isspace(c) && !inString) {\n            isEmpty = false;\n        }\n    }\n\n    // 处理没有闭合分号的最后一个文本\n    if (!isEmpty) {\n        count++;\n    }\n\n    return count;\n}"
  }
}